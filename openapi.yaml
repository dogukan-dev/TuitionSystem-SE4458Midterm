openapi: 3.0.3
info:
  title: University Tuition Payment System API
  version: 2.0.0
  description: API for managing university tuition payments, including student registration, login, tuition queries, payments, and administrative functions.

servers:
  - url: http://localhost:8080/api
    description: Local development server

security:
  - BearerAuth: []

components:
  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT

  schemas:
    TransactionStatus:
      type: object
      properties:
        status:
          type: string
          example: "Successful"
        message:
          type: string
          example: "Operation completed successfully"

    TuitionQueryResponse:
      type: object
      properties:
        student_no:
          type: string
          example: "12345678901"
        term:
          type: string
          example: "2023-Fall"
        tuition_total:
          type: number
          format: float
          example: 1500.00
        balance:
          type: number
          format: float
          example: 500.00

    PaymentResponse:
      allOf:
        - $ref: '#/components/schemas/TransactionStatus'
        - type: object
          properties:
            balance:
              type: number
              format: float
              example: 1000.00

    RegisterRequest:
      type: object
      required:
        - student_no
        - password
      properties:
        student_no:
          type: string
          example: "12345678901"
        password:
          type: string
          format: password
          example: "mypassword123"

    LoginRequest:
      type: object
      required:
        - student_no
        - password
      properties:
        student_no:
          type: string
          example: "12345678901"
        password:
          type: string
          format: password
          example: "mypassword123"

    UnpaidStudent:
      type: object
      properties:
        student_number:
          type: string
          example: "12345678901"
        term:
          type: string
          example: "2023-Fall"

    HealthResponse:
      type: object
      properties:
        status:
          type: string
          example: "healthy"
        timestamp:
          type: string
          format: date-time
          example: "2023-11-30T12:00:00Z"

    ErrorResponse:
      type: object
      properties:
        error:
          type: string
          example: "Invalid request"

paths:
  /v1/health:
    get:
      summary: Health check
      description: Check if the API is running and healthy
      responses:
        '200':
          description: API is healthy
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HealthResponse'

  /v2/health:
    get:
      summary: Health check (v2)
      description: Check if the API is running and healthy
      responses:
        '200':
          description: API is healthy
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HealthResponse'

  /v1/register:
    post:
      summary: Register a new student account
      description: Create a new student account with student number and password
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RegisterRequest'
      responses:
        '200':
          description: Registration successful
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TransactionStatus'
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v2/register:
    post:
      summary: Register a new student account (v2)
      description: Create a new student account with student number and password
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RegisterRequest'
      responses:
        '200':
          description: Registration successful
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TransactionStatus'
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/login:
    post:
      summary: Login to student account
      description: Authenticate student with student number and password
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LoginRequest'
      responses:
        '200':
          description: Login successful
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TransactionStatus'
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v2/login:
    post:
      summary: Login to student account (v2)
      description: Authenticate student with student number and password
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LoginRequest'
      responses:
        '200':
          description: Login successful
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TransactionStatus'
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/mobile/tuition:
    get:
      summary: Query tuition information (Mobile App)
      description: Get tuition details for a specific student and term
      parameters:
        - name: student_no
          in: query
          required: true
          schema:
            type: string
          description: Student number
        - name: active_term
          in: query
          required: true
          schema:
            type: string
          description: Academic term
      responses:
        '200':
          description: Tuition information retrieved
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TuitionQueryResponse'
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Student or tuition not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v2/mobile/tuition:
    get:
      summary: Query tuition information (Mobile App v2)
      description: Get tuition details for a specific student and term with authentication
      security:
        - BearerAuth: []
      parameters:
        - name: student_no
          in: query
          required: true
          schema:
            type: string
          description: Student number
        - name: active_term
          in: query
          required: true
          schema:
            type: string
          description: Academic term
      responses:
        '200':
          description: Tuition information retrieved
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TuitionQueryResponse'
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Student or tuition not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/banking/tuition:
    get:
      summary: Query tuition information (Banking App)
      description: Get tuition details for a specific student and term
      parameters:
        - name: student_no
          in: query
          required: true
          schema:
            type: string
          description: Student number
        - name: active_term
          in: query
          required: true
          schema:
            type: string
          description: Academic term
      responses:
        '200':
          description: Tuition information retrieved
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TuitionQueryResponse'
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Student or tuition not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v2/banking/tuition:
    get:
      summary: Query tuition information (Banking App v2)
      description: Get tuition details for a specific student and term with authentication
      security:
        - BearerAuth: []
      parameters:
        - name: student_no
          in: query
          required: true
          schema:
            type: string
          description: Student number
        - name: active_term
          in: query
          required: true
          schema:
            type: string
          description: Academic term
      responses:
        '200':
          description: Tuition information retrieved
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TuitionQueryResponse'
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Student or tuition not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/banking/pay:
    post:
      summary: Pay tuition
      description: Make a payment towards tuition
      parameters:
        - name: student_no
          in: query
          required: true
          schema:
            type: string
          description: Student number
        - name: term
          in: query
          required: true
          schema:
            type: string
          description: Academic term
        - name: amount
          in: query
          required: true
          schema:
            type: number
            format: float
          description: Payment amount
      responses:
        '200':
          description: Payment processed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaymentResponse'
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Student not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v2/banking/pay:
    post:
      summary: Pay tuition (v2)
      description: Make a payment towards tuition
      parameters:
        - name: student_no
          in: query
          required: true
          schema:
            type: string
          description: Student number
        - name: term
          in: query
          required: true
          schema:
            type: string
          description: Academic term
        - name: amount
          in: query
          required: true
          schema:
            type: number
            format: float
          description: Payment amount
      responses:
        '200':
          description: Payment processed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaymentResponse'
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Student not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/admin/add-student:
    post:
      summary: Add a new student
      description: Add a new student to the system with initial balance
      parameters:
        - name: student_no
          in: query
          required: true
          schema:
            type: string
          description: Student number
        - name: balance
          in: query
          required: true
          schema:
            type: number
            format: float
          description: Initial balance
      responses:
        '200':
          description: Student added successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TransactionStatus'
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v2/admin/add-student:
    post:
      summary: Add a new student (v2)
      description: Add a new student to the system with initial balance (requires authentication)
      security:
        - BearerAuth: []
      parameters:
        - name: student_no
          in: query
          required: true
          schema:
            type: string
          description: Student number
        - name: balance
          in: query
          required: true
          schema:
            type: number
            format: float
          description: Initial balance
      responses:
        '200':
          description: Student added successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TransactionStatus'
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/admin/add-tuition:
    post:
      summary: Add tuition for a single student
      description: Set tuition amount for a specific student and term
      parameters:
        - name: student_no
          in: query
          required: true
          schema:
            type: string
          description: Student number
        - name: term
          in: query
          required: true
          schema:
            type: string
          description: Academic term
        - name: tuition_amount
          in: query
          required: true
          schema:
            type: number
            format: float
          description: Tuition amount
      responses:
        '200':
          description: Tuition added successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TransactionStatus'
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v2/admin/add-tuition:
    post:
      summary: Add tuition for a single student (v2)
      description: Set tuition amount for a specific student and term (requires authentication)
      security:
        - BearerAuth: []
      parameters:
        - name: student_no
          in: query
          required: true
          schema:
            type: string
          description: Student number
        - name: term
          in: query
          required: true
          schema:
            type: string
          description: Academic term
        - name: tuition_amount
          in: query
          required: true
          schema:
            type: number
            format: float
          description: Tuition amount
      responses:
        '200':
          description: Tuition added successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TransactionStatus'
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/admin/add-tuition-batch:
    post:
      summary: Add tuition via CSV batch
      description: Upload and process tuition data from a CSV file
      responses:
        '200':
          description: Batch tuition added successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TransactionStatus'
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v2/admin/add-tuition-batch:
    post:
      summary: Add tuition via CSV batch (v2)
      description: Upload and process tuition data from a CSV file (requires authentication)
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Batch tuition added successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TransactionStatus'
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/admin/unpaid-status:
    get:
      summary: Get unpaid tuition status
      description: Retrieve list of students with unpaid tuition
      parameters:
        - name: limit
          in: query
          schema:
            type: integer
            default: 10
          description: Number of records to return
        - name: offset
          in: query
          schema:
            type: integer
            default: 0
          description: Number of records to skip
      responses:
        '200':
          description: Unpaid tuition status retrieved
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UnpaidStudent'
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v2/admin/unpaid-status:
    get:
      summary: Get unpaid tuition status (v2)
      description: Retrieve list of students with unpaid tuition (requires authentication)
      security:
        - BearerAuth: []
      parameters:
        - name: limit
          in: query
          schema:
            type: integer
            default: 10
          description: Number of records to return
        - name: offset
          in: query
          schema:
            type: integer
            default: 0
          description: Number of records to skip
      responses:
        '200':
          description: Unpaid tuition status retrieved
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UnpaidStudent'
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'